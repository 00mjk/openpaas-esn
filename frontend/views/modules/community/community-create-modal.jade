.modal(tabindex="-1", role="dialog")
  .modal-dialog
    .modal-content
      .modal-header
        button.close(type="button", ng-click="$hide()", ng-hide="sending") &times;
        h4.modal-title(ng-hide="sending") #{__('Create a new community')}
        h4.modal-title(ng-show="sending") #{__('Creating the community')}...
      .modal-body

        .row.alert.alert-info(ng-show="sending", role="alert")
          p
            i.fa.fa-cog.fa-spin
            span(ng-show="create.step === 'post'") #{__('Creating the community')}...
            span(ng-show="create.step === 'upload'") #{__('Uploading avatar')}...
            span(ng-show="create.step === 'redirect'") #{__('Redirecting to community page')}...
            span(ng-show="create.step === 'uploadfailed'") #{__('Upload failed')}!

          .progress
            .progress-bar.progress-bar-striped.active(role="progressbar", aria-valuenow="{{percent}}", aria-valuemin="0", aria-valuemax="100", style="width: {{percent}}%")
              span.sr-only {{percent}} % #{__('Complete')}

        form(name='communityForm', ng-hide="sending")
          .form-group
            #communityerror
          .form-group(ng-show="step === 0")
            label #{__('Title')}&nbsp;*
            input.form-control(type='text', ng-change="validateTitle()", ng-model='community.title', id="title", name='title', placeholder="#{__('Title')}", autofocus=true, required)
            span.help-block #{__('Community title. Have to be unique in the current domain')}.
          .form-group(ng-show="step === 0")
            fieldset(disabled)
              label #{__('Visiblity')}&nbsp;
              .radio
                label
                  input(type="radio", name="rigths", ng-model="community.rights", value="open", checked)
                  | #{__('Open')}
                  span.help-block #{__('Publish content from and for everyone. Each user can freely read, join and participate to the community')}.
              .radio
                label
                  input(type="radio", name="rigths", ng-model="community.rights", value="restricted")
                  | #{__('Restricted')}
                  span.help-block #{__('Content is freely accessible to all users, but only members can participate')}.
              .radio
                label
                  input(type="radio", name="rigths", ng-model="community.rights", value="private")
                  | #{__('Private')}
                  span.help-block #{__('Only members can read and publish contents in this community. Each user can request membership')}.
              .radio
                label
                  input(type="radio", name="rigths", ng-model="community.rights", value="confidential")
                  | #{__('Confidential')}
                  span.help-block #{__('Only members of this community can read and publish content. All informations about this community are hidden to other users. Membership is only available by invitation')}.
          .form-group(ng-show="step === 1")
            label #{__('Avatar')}
            .row
              .col-xs-3.col-md-3.col-lg-3
                .row
                  label
                    span.btn.btn-info.btn-file #{__('Select an image')}...
                      input(type="file", load-button)
                .row(ng-show='imageselected')
                  canvas(width="128", height="128", id="preview", img-preview)
              .col-xs-9.col-md-9.col-lg-9(ng-show='imageselected')
                img-loaded(width="380")
          .form-group(ng-show="step === 1")
            label #{__('Description')}
            textarea.form-control.textarea-fixed(rows="3", ng-model='community.description', name='description')
            span.help-block #{__("A Human readable description which will help users to know what this community is about")}.
      .modal-footer.widget
        button.btn.btn-default.pull-left(type="button", ng-disabled="sending", ng-show="step === 1", ng-click="step = 0") #{__('Previous')}
        button.btn.btn-default(type="button", ng-disabled="!validateTitle()", ng-show="step === 0", ng-click="step = 1") #{__('Next')}
        button.btn.btn-primary(type="button", ng-disabled="sending", ng-show="step === 1" ng-click="create(community)") #{__('Create')}
        button.btn.btn-default(type="button", ng-disabled="sending", ng-click="$hide()") #{__('Cancel')}